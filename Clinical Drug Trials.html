<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Romaisa Nadeem">

<title>Clinical Drug Trials</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Clinical Drug Trials_files/libs/clipboard/clipboard.min.js"></script>
<script src="Clinical Drug Trials_files/libs/quarto-html/quarto.js"></script>
<script src="Clinical Drug Trials_files/libs/quarto-html/popper.min.js"></script>
<script src="Clinical Drug Trials_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Clinical Drug Trials_files/libs/quarto-html/anchor.min.js"></script>
<link href="Clinical Drug Trials_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Clinical Drug Trials_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Clinical Drug Trials_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Clinical Drug Trials_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Clinical Drug Trials_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Clinical Drug Trials</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Romaisa Nadeem </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Each year, new drugs are approved based on evaluations of their safety and effectiveness through clinical trials. Recently, there has been growing public interest in ensuring fair representation of various subgroups, such as women and racial minorities, in these trials. To address concerns about transparency and representation, the FDA has published Drug Trials Snapshot Summary Report (2015 and 2016) (2017) and the Drugs Trials Snapshots (2023).</p>
<p>I will be exploring two datasets: Clinical Trials: Participant Demographics Dataset (2018) and the Drug Trials Snapshots (2023) dataset.</p>
</section>
<section id="about-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="about-the-dataset">About the Dataset</h2>
<section id="clinical-trials-participant-demographics-dataset" class="level3">
<h3 class="anchored" data-anchor-id="clinical-trials-participant-demographics-dataset">Clinical Trials: Participant Demographics Dataset</h3>
<p>The Clinical Trials: Participant Demographic Data dataset covers demographic details for participants in clinical trials for FDA approved drugs between January 2015 and mid August 2018.</p>
<p>The columns include:</p>
<ul>
<li><p><strong>Brand Name</strong>: The commercial name of each drug in the clinical trials.</p></li>
<li><p><strong>Drug Indication</strong>: The medical condition the drug is intended to treat.</p></li>
<li><p><strong>Percentage of Women</strong>: The proportion of women participants in each trial.</p></li>
<li><p><strong>Percentage by Race</strong>: Breakdown of participants by race, including:</p>
<ul>
<li><strong>White</strong></li>
<li><strong>Black or African American</strong></li>
<li><strong>Asian</strong></li>
<li><strong>Other</strong>: This category aggregates other races, including American Indian/Alaska Native, Native Hawaiian/Other Pacific Islander, mixed races, unknown, and unreported.</li>
</ul></li>
<li><p><strong>Percentage of Hispanic Ethnicity</strong>: The percentage of Hispanic participants, although this category wasn’t included in summary reports for 2015 and 2016.</p></li>
<li><p><strong>Percentage Age 65+</strong>: The proportion of trial participants aged 65 and older.</p></li>
<li><p><strong>Year</strong>: The year the data was recorded or the drug was approved.</p></li>
<li><p>The “other rate” column encompasses of any of the following: American Indian/Alaska Native (AI/AN), Native Hawaiian or Other Pacific Islander (NH/OPI), mixed race, multiple races, Unknown, Unreported, and Other.</p></li>
</ul>
<p>For drugs approved in 2015 and 2016, percentages for the “Other” category were provided in FDA summary reports. For drugs approved in 2017, ProPublica calculated this percentage by subtracting the sum of other categories from 100 percent. For 2018, ProPublica manually compiled this information for each individual drug.</p>
<p>The categories “Hispanic” and “United States ethnicity” were not included in the FDA’s yearly summary reports for 2015 and 2016, although they sometimes appear in individual drug reports. This category includes one of the following labels: Hispanic, Not Hispanic, and Unknown/Unreported.</p>
</section>
<section id="drug-trials-snapshot-dataset" class="level3">
<h3 class="anchored" data-anchor-id="drug-trials-snapshot-dataset">Drug Trials Snapshot Dataset</h3>
<p>This dataset is a record of drug trial snapshots from the FDA, covering details about each drug, including its approval information and intended use.</p>
<p>The columns include:</p>
<ul>
<li><p><strong>Brand Name (Drug Trials Snapshot)</strong>: Lists the brand names of drugs that have undergone clinical trials.</p></li>
<li><p><strong>Drug Name</strong>: The chemical or generic name of each drug.</p></li>
<li><p><strong>Original Date of FDA Approval</strong>: The date when the drug received its first FDA approval.</p></li>
<li><p><strong>FDA Approved Use on Original Approval Date</strong>: Describes the specific medical condition or purpose for which the drug was approved by the FDA initially.</p></li>
<li><p><strong>Brand Name (Prescribing Information)</strong>: Another brand name column, possibly reflecting the name used in prescribing information.</p></li>
</ul>
</section>
</section>
<section id="questions" class="level2">
<h2 class="anchored" data-anchor-id="questions">Questions</h2>
<p>In this project, I intend to explore gender and racial biases in clinical drug trials.</p>
<p>I will do show by exploring the following questions:</p>
<ul>
<li><p><strong>Are there any potential biases in clinical trials based on age, gender or race?</strong></p></li>
<li><p><strong>Which demographic groups receive the greatest benefit from the drugs being tested in clinical trials?</strong></p></li>
</ul>
<p>While these questions are interesting, they also have very important medical and societal implications. Addressing these biases is essential for promoting equality in healthcare, as unrecognized biases in clinical trials may lead to significant disparities in treatment outcomes, sometimes with severe consequences for patient health and safety. Ensuring fair representation in clinical trials is a step toward more equitable and effective medical treatments for all groups.</p>
</section>
<section id="clinical-trials-participant-demographics-dataset-1" class="level2">
<h2 class="anchored" data-anchor-id="clinical-trials-participant-demographics-dataset-1">Clinical Trials: Participant Demographics Dataset</h2>
</section>
<section id="iteration-1" class="level2">
<h2 class="anchored" data-anchor-id="iteration-1">Iteration 1</h2>
<section id="phase-1" class="level3">
<h3 class="anchored" data-anchor-id="phase-1">Phase 1</h3>
<ol type="1">
<li>Read the csv file into R
<ul>
<li>Specify column types</li>
</ul></li>
<li>Make the column names lowercase</li>
<li>Drop Hispanic and USA columns
<ul>
<li>Pivot race columns to longer</li>
</ul></li>
<li>Pivot Age columns to longer</li>
<li>Identify UIDs
<ul>
<li>Sort tibble by UID</li>
</ul></li>
<li>Display final tibble</li>
</ol>
</section>
<section id="phase-2" class="level3">
<h3 class="anchored" data-anchor-id="phase-2">Phase 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Read in the 1st CSV file. </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./clinical_trials_data.csv"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">col_types =</span> <span class="st">"cccccccccccccc"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">na =</span> <span class="fu">c</span>(<span class="st">"N/A"</span>, <span class="st">"NR"</span>, <span class="st">"Not reported"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 155
Columns: 14
$ `BRAND NAME`                                                                                                                                &lt;chr&gt; …
$ INDICATION                                                                                                                                  &lt;chr&gt; …
$ WOMEN                                                                                                                                       &lt;chr&gt; …
$ WHITE                                                                                                                                       &lt;chr&gt; …
$ `BLACK OR AFRICAN AMERICAN`                                                                                                                 &lt;chr&gt; …
$ ASIAN                                                                                                                                       &lt;chr&gt; …
$ `ALL OTHER (Aggregated):\nAmerican Indian or Alaska Native (AI/AN), Native Hawaiian or Other Pacific Islander (NH/OPI), Unknown/Unreported` &lt;chr&gt; …
$ `HISPANIC OR LATINO (2017 AND LATER ONLY)`                                                                                                  &lt;chr&gt; …
$ `UNITED STATES (2017 ONLY)`                                                                                                                 &lt;chr&gt; …
$ `AGE\n65 and OLDER`                                                                                                                         &lt;chr&gt; …
$ `AGE\n75 and OLDER`                                                                                                                         &lt;chr&gt; …
$ `AGE\n80 and OLDER`                                                                                                                         &lt;chr&gt; …
$ YEAR                                                                                                                                        &lt;chr&gt; …
$ NOTES                                                                                                                                       &lt;chr&gt; …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Make column names lowercase</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&lt;&gt;%</span> <span class="fu">rename_with</span>(tolower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.Dropping Hispanic and USA data from 2017 and later</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&lt;&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="st">`</span><span class="at">hispanic or latino (2017 and later only)</span><span class="st">`</span> <span class="ot">=</span> <span class="cn">NULL</span>, <span class="st">`</span><span class="at">united states (2017 only)</span><span class="st">`</span> <span class="ot">=</span> <span class="cn">NULL</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot race</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&lt;&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(women, <span class="st">`</span><span class="at">brand name</span><span class="st">`</span>, indication, year, notes, <span class="st">`</span><span class="at">age</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">65 and older</span><span class="st">`</span>, <span class="st">`</span><span class="at">age</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="at">75 and older</span><span class="st">`</span>, <span class="st">`</span><span class="at">age</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="at">80 and older</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"race"</span>, <span class="at">values_to =</span> <span class="st">"percent race"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Hispanic and USA columns are being dropped because they are missing values for more than 50% of the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Pivot age</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&lt;&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  women, <span class="st">`</span><span class="at">brand name</span><span class="st">`</span>, indication, year, notes, race,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">percent race</span><span class="st">`</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>), <span class="at">names_to =</span> <span class="st">"age"</span>, <span class="at">values_to =</span> <span class="st">"percent age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,860
Columns: 9
$ `brand name`   &lt;chr&gt; "ADDYI", "ADDYI", "ADDYI", "ADDYI", "ADDYI", "ADDYI", "…
$ indication     &lt;chr&gt; "Treatment of acquired, generalized hypoactive sexual d…
$ women          &lt;chr&gt; "100%", "100%", "100%", "100%", "100%", "100%", "100%",…
$ year           &lt;chr&gt; "2015", "2015", "2015", "2015", "2015", "2015", "2015",…
$ notes          &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", "", "",…
$ race           &lt;chr&gt; "white", "white", "white", "black or african american",…
$ `percent race` &lt;chr&gt; "89%", "89%", "89%", "8%", "8%", "8%", "1%", "1%", "1%"…
$ age            &lt;chr&gt; "age\n65 and older", "age\n75 and older", "age\n80 and …
$ `percent age`  &lt;chr&gt; "0%", "0%", "0%", "0%", "0%", "0%", "0%", "0%", "0%", "…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Identify UID</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(<span class="st">`</span><span class="at">brand name</span><span class="st">`</span>, indication, year, race, age) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim_desc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "[0 x 6]"</code></pre>
</div>
</div>
<p>Looks like a good UID.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort tibble by uid</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&lt;&gt;%</span> <span class="fu">arrange</span>(<span class="st">`</span><span class="at">brand name</span><span class="st">`</span>, indication, year, race, age)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,860
Columns: 9
$ `brand name`   &lt;chr&gt; "ADDYI", "ADDYI", "ADDYI", "ADDYI", "ADDYI", "ADDYI", "…
$ indication     &lt;chr&gt; "Treatment of acquired, generalized hypoactive sexual d…
$ women          &lt;chr&gt; "100%", "100%", "100%", "100%", "100%", "100%", "100%",…
$ year           &lt;chr&gt; "2015", "2015", "2015", "2015", "2015", "2015", "2015",…
$ notes          &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", "", "",…
$ race           &lt;chr&gt; "all other (aggregated):\namerican indian or alaska nat…
$ `percent race` &lt;chr&gt; "2%", "2%", "2%", "1%", "1%", "1%", "8%", "8%", "8%", "…
$ age            &lt;chr&gt; "age\n65 and older", "age\n75 and older", "age\n80 and …
$ `percent age`  &lt;chr&gt; "0%", "0%", "0%", "0%", "0%", "0%", "0%", "0%", "0%", "…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Final tibble</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">brand name</span><span class="st">`</span>, women, year, <span class="st">`</span><span class="at">percent age</span><span class="st">`</span>, <span class="st">`</span><span class="at">percent race</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">brand name</th>
<th style="text-align: left;">women</th>
<th style="text-align: left;">year</th>
<th style="text-align: left;">percent age</th>
<th style="text-align: left;">percent race</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DUPIXENT</td>
<td style="text-align: left;">42%</td>
<td style="text-align: left;">2017</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">6%</td>
</tr>
<tr class="even">
<td style="text-align: left;">HEMLIBRA</td>
<td style="text-align: left;">0%</td>
<td style="text-align: left;">2017</td>
<td style="text-align: left;">3%</td>
<td style="text-align: left;">7%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RYDAPT</td>
<td style="text-align: left;">56%</td>
<td style="text-align: left;">2017</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">EUCRISA</td>
<td style="text-align: left;">56%</td>
<td style="text-align: left;">2016</td>
<td style="text-align: left;">0%</td>
<td style="text-align: left;">61%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BRAFTOVI</td>
<td style="text-align: left;">41%</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">91%</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="clinical-trials-participant-demographics-dataset-2" class="level2">
<h2 class="anchored" data-anchor-id="clinical-trials-participant-demographics-dataset-2">Clinical Trials: Participant Demographics Dataset</h2>
</section>
<section id="iteration-2" class="level2">
<h2 class="anchored" data-anchor-id="iteration-2">Iteration 2</h2>
<section id="phase-1-1" class="level3">
<h3 class="anchored" data-anchor-id="phase-1-1">Phase 1</h3>
<ol type="1">
<li>Drop notes column</li>
<li>Convert columns to correct data types
<ul>
<li>year to date type</li>
<li>brand name to factor</li>
<li>race to factor (after renaming “other” values)</li>
<li>age to factor (after renaming “age” values)</li>
</ul></li>
<li>Standardize indication column
<ul>
<li>remove filler words</li>
<li>keep key words and disease names</li>
</ul></li>
<li>Remove “%” and “&lt;” symbols</li>
<li>Convert percentages to numerics</li>
<li>Drop NAs</li>
<li>Display final tibble</li>
</ol>
</section>
<section id="phase-2-1" class="level3">
<h3 class="anchored" data-anchor-id="phase-2-1">Phase 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Dropping notes column</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&lt;&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">notes =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Converting data types</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert year column to date</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">make_date</span>(<span class="at">year =</span> year),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert brand name column to factor</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">brand name</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_factor</span>(<span class="st">`</span><span class="at">brand name</span><span class="st">`</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shorten "all other" data in race column</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">race =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(race, <span class="st">"^all"</span>), <span class="st">"other"</span>, race), </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shorten "black or african america" data in race column</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">race =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(race, <span class="st">"^black"</span>), <span class="st">"black"</span>, race), </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert race to factor</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">race =</span> <span class="fu">as_factor</span>(race)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,860
Columns: 8
$ `brand name`   &lt;fct&gt; ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI,…
$ indication     &lt;chr&gt; "Treatment of acquired, generalized hypoactive sexual d…
$ women          &lt;chr&gt; "100%", "100%", "100%", "100%", "100%", "100%", "100%",…
$ year           &lt;date&gt; 2015-01-01, 2015-01-01, 2015-01-01, 2015-01-01, 2015-0…
$ race           &lt;fct&gt; other, other, other, asian, asian, asian, black, black,…
$ `percent race` &lt;chr&gt; "2%", "2%", "2%", "1%", "1%", "1%", "8%", "8%", "8%", "…
$ age            &lt;chr&gt; "age\n65 and older", "age\n75 and older", "age\n80 and …
$ `percent age`  &lt;chr&gt; "0%", "0%", "0%", "0%", "0%", "0%", "0%", "0%", "0%", "…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Continued... Shorten age data and convert to factor</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&lt;&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">age =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>age <span class="sc">==</span> <span class="st">"age</span><span class="sc">\n</span><span class="st">65 and older"</span> <span class="sc">~</span> <span class="st">"65 to 74"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>age <span class="sc">==</span> <span class="st">"age</span><span class="sc">\n</span><span class="st">75 and older"</span> <span class="sc">~</span> <span class="st">"75 to 79"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>age <span class="sc">==</span> <span class="st">"age</span><span class="sc">\n</span><span class="st">80 and older"</span> <span class="sc">~</span> <span class="st">"80 and up"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">~</span> age</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="at">age =</span> <span class="fu">as_factor</span>(age)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,860
Columns: 8
$ `brand name`   &lt;fct&gt; ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI,…
$ indication     &lt;chr&gt; "Treatment of acquired, generalized hypoactive sexual d…
$ women          &lt;chr&gt; "100%", "100%", "100%", "100%", "100%", "100%", "100%",…
$ year           &lt;date&gt; 2015-01-01, 2015-01-01, 2015-01-01, 2015-01-01, 2015-0…
$ race           &lt;fct&gt; other, other, other, asian, asian, asian, black, black,…
$ `percent race` &lt;chr&gt; "2%", "2%", "2%", "1%", "1%", "1%", "8%", "8%", "8%", "…
$ age            &lt;fct&gt; 65 to 74, 75 to 79, 80 and up, 65 to 74, 75 to 79, 80 a…
$ `percent age`  &lt;chr&gt; "0%", "0%", "0%", "0%", "0%", "0%", "0%", "0%", "0%", "…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3: Standardize indication column, keeping key words</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">indication =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(indication, <span class="st">"[Tt]reatment"</span>) <span class="sc">~</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">if_else</span>(<span class="fu">str_detect</span>(indication, <span class="st">"</span><span class="sc">\\</span><span class="st">([ˆ()]+</span><span class="sc">\\</span><span class="st">)"</span>),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">str_c</span>(<span class="st">"treatment, "</span>, <span class="fu">str_extract</span>(indication, <span class="st">"</span><span class="sc">\\</span><span class="st">([ˆ()]+</span><span class="sc">\\</span><span class="st">)"</span>)),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">str_to_lower</span>(indication)),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(indication, <span class="st">"[Pp]revent"</span>) <span class="sc">~</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">if_else</span>(<span class="fu">str_detect</span>(indication, <span class="st">"</span><span class="sc">\\</span><span class="st">([ˆ()]+</span><span class="sc">\\</span><span class="st">)"</span>),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">str_c</span>(<span class="st">"preventative treatment, "</span>, <span class="fu">str_extract</span>(indication, <span class="st">"</span><span class="sc">\\</span><span class="st">([ˆ()]+</span><span class="sc">\\</span><span class="st">)"</span>)),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">str_to_lower</span>(indication)),</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> indication</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Removing filler words and keeping disease names</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">indication =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(indication, <span class="st">"[Ff]or"</span>), <span class="fu">str_remove_all</span>(indication, <span class="st">"[Ff]or"</span>), indication),</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">indication =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(indication, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>), <span class="fu">str_remove</span>(indication, <span class="st">"</span><span class="sc">\\</span><span class="st">.$"</span>), indication),</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">indication =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(indication, <span class="st">"associated with"</span>), <span class="fu">str_remove_all</span>(indication, <span class="st">"associated with "</span>), indication),</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">indication =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(indication, <span class="st">"adults who"</span>), <span class="fu">str_remove_all</span>(indication, <span class="st">"(, adults who).*"</span>), indication),</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">indication =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(indication, <span class="st">"patients two"</span>), <span class="fu">str_remove_all</span>(indication, <span class="st">"(, patients two).*"</span>), indication)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 4: Removing "%" and "&lt;" symbols and converting to numeric</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">women =</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove_all</span>(women, <span class="st">"[%&lt;]"</span>)),</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">percent race</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove_all</span>(<span class="st">`</span><span class="at">percent race</span><span class="st">`</span>, <span class="st">"[%&lt;]"</span>)),</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">percent age</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove_all</span>(<span class="st">`</span><span class="at">percent age</span><span class="st">`</span>, <span class="st">"[%&lt;]"</span>))</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,860
Columns: 8
$ `brand name`   &lt;fct&gt; ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI,…
$ indication     &lt;chr&gt; "treatment of acquired, generalized hypoactive sexual d…
$ women          &lt;dbl&gt; 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, …
$ year           &lt;date&gt; 2015-01-01, 2015-01-01, 2015-01-01, 2015-01-01, 2015-0…
$ race           &lt;fct&gt; other, other, other, asian, asian, asian, black, black,…
$ `percent race` &lt;dbl&gt; 2, 2, 2, 1, 1, 1, 8, 8, 8, 89, 89, 89, 2, 2, 2, 32, 32,…
$ age            &lt;fct&gt; 65 to 74, 75 to 79, 80 and up, 65 to 74, 75 to 79, 80 a…
$ `percent age`  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19, NA, NA, 19, NA,…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check percentages</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> race, <span class="at">values_from =</span> <span class="st">`</span><span class="at">percent race</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">total_percent =</span> <span class="fu">sum</span>(<span class="fu">c</span>(other, asian, black, white))) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="st">`</span><span class="at">brand name</span><span class="st">`</span>, other, asian, black, white, total_percent) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(total_percent <span class="sc">!=</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 99 × 6
   `brand name` other asian black white total_percent
   &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
 1 ADLYXIN§         2    32     3    64           101
 2 ADLYXIN§         2    32     3    64           101
 3 ADLYXIN§         2    32     3    64           101
 4 AKYNZEO          1     1     1   100           103
 5 AKYNZEO          1     1     1   100           103
 6 AKYNZEO          1     1     1   100           103
 7 ALECENSA         7    18     2    74           101
 8 ALECENSA         7    18     2    74           101
 9 ALECENSA         7    18     2    74           101
10 ARISTADA         1    13    40    47           101
# ℹ 89 more rows</code></pre>
</div>
</div>
<p>As seen above, the sum of the race columns does not add up exactly a 100%. This may be due to a error in data collection.</p>
<p>I will leave the data as it is.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Check summary</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    brand name    indication            women             year           
 AVYCAZ  :  24   Length:1860        Min.   :  0.00   Min.   :2015-01-01  
 CHOLBAM :  24   Class :character   1st Qu.: 37.00   1st Qu.:2015-01-01  
 CRESEMBA:  24   Mode  :character   Median : 44.00   Median :2016-01-01  
 REXULTI :  24                      Mean   : 47.96   Mean   :2016-04-21  
 RYDAPT  :  24                      3rd Qu.: 59.00   3rd Qu.:2017-01-01  
 SAVAYSA :  24                      Max.   :100.00   Max.   :2018-01-01  
 (Other) :1716                                                           
    race      percent race           age       percent age   
 other:465   Min.   :  0.00   65 to 74 :620   Min.   : 0.00  
 asian:465   1st Qu.:  2.00   75 to 79 :620   1st Qu.: 1.00  
 black:465   Median :  7.00   80 and up:620   Median : 7.00  
 white:465   Mean   : 25.20                   Mean   :16.92  
             3rd Qu.: 46.25                   3rd Qu.:29.00  
             Max.   :100.00                   Max.   :90.00  
             NA's   :24                       NA's   :856    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Drop NAs</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&lt;&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">drop_na</span>()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 995
Columns: 8
$ `brand name`   &lt;fct&gt; ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI, ADDYI,…
$ indication     &lt;chr&gt; "treatment of acquired, generalized hypoactive sexual d…
$ women          &lt;dbl&gt; 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, …
$ year           &lt;date&gt; 2015-01-01, 2015-01-01, 2015-01-01, 2015-01-01, 2015-0…
$ race           &lt;fct&gt; other, other, other, asian, asian, asian, black, black,…
$ `percent race` &lt;dbl&gt; 2, 2, 2, 1, 1, 1, 8, 8, 8, 89, 89, 89, 2, 32, 3, 64, 8,…
$ age            &lt;fct&gt; 65 to 74, 75 to 79, 80 and up, 65 to 74, 75 to 79, 80 a…
$ `percent age`  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19, 19, 19, 19, 34,…</code></pre>
</div>
</div>
<p>There are no outliers in the data, and 865 rows were dropped.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Display final tibble </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 71%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">brand name</th>
<th style="text-align: left;">indication</th>
<th style="text-align: right;">women</th>
<th style="text-align: left;">year</th>
<th style="text-align: left;">race</th>
<th style="text-align: right;">percent race</th>
<th style="text-align: left;">age</th>
<th style="text-align: right;">percent age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AVYCAZ</td>
<td style="text-align: left;">treatment of complicated urinary tract infection (abbreviated as cuti)</td>
<td style="text-align: right;">74</td>
<td style="text-align: left;">2015-01-01</td>
<td style="text-align: left;">asian</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">80 and up</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">XIIDRA</td>
<td style="text-align: left;">treatment of the signs and symptoms of dry eye disease</td>
<td style="text-align: right;">76</td>
<td style="text-align: left;">2016-01-01</td>
<td style="text-align: left;">black</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">65 to 74</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IDHIFA</td>
<td style="text-align: left;">treatment of relapsed acute myelogenous leukemia</td>
<td style="text-align: right;">49</td>
<td style="text-align: left;">2017-01-01</td>
<td style="text-align: left;">other</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">65 to 74</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="even">
<td style="text-align: left;">TIBSOVO</td>
<td style="text-align: left;">treatment of adults with acute myeloid leukemia (aml) that have a mutation in a gene called idh1 and whose disease has come back or has not improved after previous treatment(s)</td>
<td style="text-align: right;">50</td>
<td style="text-align: left;">2018-01-01</td>
<td style="text-align: left;">asian</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">65 to 74</td>
<td style="text-align: right;">63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TAGRISSO</td>
<td style="text-align: left;">treatment of patients with advanced non-small cell lung cancer (nsclc)</td>
<td style="text-align: right;">68</td>
<td style="text-align: left;">2015-01-01</td>
<td style="text-align: left;">black</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">75 to 79</td>
<td style="text-align: right;">13</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="drug-trials-snapshots-dataset" class="level2">
<h2 class="anchored" data-anchor-id="drug-trials-snapshots-dataset">Drug Trials Snapshots Dataset</h2>
</section>
<section id="iteration-3" class="level2">
<h2 class="anchored" data-anchor-id="iteration-3">Iteration 3</h2>
<section id="phase-1-2" class="level3">
<h3 class="anchored" data-anchor-id="phase-1-2">Phase 1</h3>
<ol type="1">
<li>Read the csv file into R
<ul>
<li>Skip first column</li>
</ul></li>
<li>Change column names to lower</li>
<li>Drop brand name prescribing information column</li>
<li>Identify UID
<ul>
<li>Sort tibble by UID</li>
</ul></li>
<li>Display final tibble</li>
</ol>
</section>
<section id="phase-2-2" class="level3">
<h3 class="anchored" data-anchor-id="phase-2-2">Phase 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Read csv</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./drug_trials_snapshot_fda.csv"</span>, <span class="at">skip =</span> <span class="dv">1</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 447
Columns: 5
$ `Brand Name (Drug Trials Snapshot)`           &lt;chr&gt; "NEMLUVIO", "YORVIPATH",…
$ `Drug Name`                                   &lt;chr&gt; "nemolizumab-ilto", "pal…
$ `Original Date of FDA Approval`               &lt;chr&gt; "August 12, 2024", "Augu…
$ `FDA Approved Use on Original Approval Date*` &lt;chr&gt; "To treat prurigo nodula…
$ `Brand Name (Prescribing Information)`        &lt;chr&gt; "Nemluvio", "Yorvipath",…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Changing column names to lowercase</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&lt;&gt;%</span> <span class="fu">rename_with</span>(tolower)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&gt;%</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 447
Columns: 5
$ `brand name (drug trials snapshot)`           &lt;chr&gt; "NEMLUVIO", "YORVIPATH",…
$ `drug name`                                   &lt;chr&gt; "nemolizumab-ilto", "pal…
$ `original date of fda approval`               &lt;chr&gt; "August 12, 2024", "Augu…
$ `fda approved use on original approval date*` &lt;chr&gt; "To treat prurigo nodula…
$ `brand name (prescribing information)`        &lt;chr&gt; "Nemluvio", "Yorvipath",…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Drop prescribing name column</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">brand name (prescribing information)</span><span class="st">`</span> <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dropping this column because it does not provide any useful information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Identify uid</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(<span class="st">`</span><span class="at">original date of fda approval</span><span class="st">`</span>, <span class="st">`</span><span class="at">fda approved use on original approval date*</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 3
# ℹ 3 variables: original date of fda approval &lt;chr&gt;,
#   fda approved use on original approval date* &lt;chr&gt;, n &lt;int&gt;</code></pre>
</div>
</div>
<p>Seems to be a good UID.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort tibble by uid</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&lt;&gt;%</span> <span class="fu">arrange</span>(<span class="st">`</span><span class="at">original date of fda approval</span><span class="st">`</span>, <span class="st">`</span><span class="at">fda approved use on original approval date*</span><span class="st">`</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check structure</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 447
Columns: 4
$ `brand name (drug trials snapshot)`           &lt;chr&gt; "KOSELUGO", "VENCLEXTA",…
$ `drug name`                                   &lt;chr&gt; "selumetinib", "venetocl…
$ `original date of fda approval`               &lt;chr&gt; "April 10,2020", "April …
$ `fda approved use on original approval date*` &lt;chr&gt; "For the treatment of pl…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Final tibble</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="st">`</span><span class="at">brand name (drug trials snapshot)</span><span class="st">`</span>, <span class="st">`</span><span class="at">original date of fda approval</span><span class="st">`</span>, <span class="st">`</span><span class="at">drug name</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 27%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">brand name (drug trials snapshot)</th>
<th style="text-align: left;">original date of fda approval</th>
<th style="text-align: left;">drug name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FABHLATA</td>
<td style="text-align: left;">December 5, 2023</td>
<td style="text-align: left;">iptacopan</td>
</tr>
<tr class="even">
<td style="text-align: left;">RYZODEG</td>
<td style="text-align: left;">September 26, 2015</td>
<td style="text-align: left;">insulin degludec and insulin aspart injection</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BRENZAVVY&nbsp;</td>
<td style="text-align: left;">January 20, 2023</td>
<td style="text-align: left;">bexagliflozin</td>
</tr>
<tr class="even">
<td style="text-align: left;">VYZULTA</td>
<td style="text-align: left;">November 2, 2017&nbsp;</td>
<td style="text-align: left;">latanoprostene bunod</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="drug-trials-snapshots-dataset-1" class="level2">
<h2 class="anchored" data-anchor-id="drug-trials-snapshots-dataset-1">Drug Trials Snapshots Dataset</h2>
</section>
<section id="iteration-4" class="level2">
<h2 class="anchored" data-anchor-id="iteration-4">Iteration 4</h2>
<section id="phase-1-3" class="level3">
<h3 class="anchored" data-anchor-id="phase-1-3">Phase 1</h3>
<ol type="1">
<li>Rename columns</li>
<li>Convert approval to date to date type</li>
<li>Standardize approved use column
<ul>
<li>Keep key words, remove filler words and keep disease names</li>
</ul></li>
<li>Drop NAs</li>
<li>Display final tibble</li>
</ol>
</section>
<section id="phase-2-3" class="level3">
<h3 class="anchored" data-anchor-id="phase-2-3">Phase 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Rename columns</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&lt;&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">approved use</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">fda approved use on original approval date*</span><span class="st">`</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">approval date</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">original date of fda approval</span><span class="st">`</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">brand name</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">brand name (drug trials snapshot)</span><span class="st">`</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 447
Columns: 4
$ `brand name`    &lt;chr&gt; "KOSELUGO", "VENCLEXTA", "INGREZZA", "BALVERSA", "CORL…
$ `drug name`     &lt;chr&gt; "selumetinib", "venetoclax", "valbenazine", "erdafitin…
$ `approval date` &lt;chr&gt; "April 10,2020", "April 11, 2016", "April 11, 2017", "…
$ `approved use`  &lt;chr&gt; "For the treatment of plexiform neurofibroma", "Treatm…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Convert approval date to Date type</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&lt;&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="st">`</span><span class="at">approval date</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.Date</span>(<span class="st">`</span><span class="at">approval date</span><span class="st">`</span>, <span class="at">format =</span> <span class="st">"%B %d, %Y"</span>))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 447
Columns: 4
$ `brand name`    &lt;chr&gt; "KOSELUGO", "VENCLEXTA", "INGREZZA", "BALVERSA", "CORL…
$ `drug name`     &lt;chr&gt; "selumetinib", "venetoclax", "valbenazine", "erdafitin…
$ `approval date` &lt;date&gt; 2020-04-10, 2016-04-11, 2017-04-11, 2019-04-12, 2015-…
$ `approved use`  &lt;chr&gt; "For the treatment of plexiform neurofibroma", "Treatm…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Standardize approved use column by keeping key words</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&lt;&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">approved use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"[Tt]reatment"</span>) <span class="sc">~</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">if_else</span>(</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">([^)]+</span><span class="sc">\\</span><span class="st">)"</span>),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"treatment, "</span>, <span class="fu">str_extract</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">([^)]+</span><span class="sc">\\</span><span class="st">)"</span>)),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_to_lower</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"[Pp]revent"</span>) <span class="sc">~</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">if_else</span>(</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">([^)]+</span><span class="sc">\\</span><span class="st">)"</span>),</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"preventative treatment, "</span>, <span class="fu">str_extract</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">([^)]+</span><span class="sc">\\</span><span class="st">)"</span>)),</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_to_lower</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Default case to keep `approved use` as it is</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">`</span><span class="at">approved use</span><span class="st">`</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing filler words and keeping disease names</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&lt;&gt;%</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">approved use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">str_replace</span>(</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"^[A-Z]"</span>, <span class="fu">str_to_lower</span>(<span class="fu">str_sub</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">approved use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">if_else</span>(</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"[Ff]or"</span>),</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_remove_all</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"[Ff]or"</span>),</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">approved use</span><span class="st">`</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">approved use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">if_else</span>(</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>),</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_remove</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">.$"</span>),</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">approved use</span><span class="st">`</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">approved use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">if_else</span>(</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"associated with"</span>),</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_remove_all</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"associated with "</span>),</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">approved use</span><span class="st">`</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">approved use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">if_else</span>(</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"adults who"</span>),</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_remove_all</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"(?=(, adults who)).*"</span>),</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">approved use</span><span class="st">`</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">approved use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">if_else</span>(</span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"patients two"</span>),</span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_remove_all</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"(?=(, patients two)).*"</span>),</span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">approved use</span><span class="st">`</span></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional cleanup: Remove leading whitespace and "the " at the start</span></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">approved use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">str_trim</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>),</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">approved use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">str_replace</span>(<span class="st">`</span><span class="at">approved use</span><span class="st">`</span>, <span class="st">"^the "</span>, <span class="st">""</span>)</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  brand name         drug name         approval date        approved use      
 Length:447         Length:447         Min.   :2014-05-08   Length:447        
 Class :character   Class :character   1st Qu.:2017-08-29   Class :character  
 Mode  :character   Mode  :character   Median :2019-10-21   Mode  :character  
                                       Mean   :2019-10-12                     
                                       3rd Qu.:2021-11-23                     
                                       Max.   :2024-08-14                     
                                       NA's   :2                              </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&lt;&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop_na</span>(., <span class="st">`</span><span class="at">approval date</span><span class="st">`</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  brand name         drug name         approval date        approved use      
 Length:445         Length:445         Min.   :2014-05-08   Length:445        
 Class :character   Class :character   1st Qu.:2017-08-29   Class :character  
 Mode  :character   Mode  :character   Median :2019-10-21   Mode  :character  
                                       Mean   :2019-10-12                     
                                       3rd Qu.:2021-11-23                     
                                       Max.   :2024-08-14                     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Final tibble</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>drug_snapshots <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 9%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">brand name</th>
<th style="text-align: left;">drug name</th>
<th style="text-align: left;">approval date</th>
<th style="text-align: left;">approved use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PAXLOVID</td>
<td style="text-align: left;">nirmatrelvir, ritonavir</td>
<td style="text-align: left;">2023-05-25</td>
<td style="text-align: left;">to treat mild-to-moderate COVID-19 in adults at high risk progression to severe COVID-19</td>
</tr>
<tr class="even">
<td style="text-align: left;">BENZNIDAZOLE</td>
<td style="text-align: left;">Benznidazole</td>
<td style="text-align: left;">2017-08-29</td>
<td style="text-align: left;">treatment of chagas disease in children 2 to 12 years of age</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CABENUVA</td>
<td style="text-align: left;">cabotegravir and rilpivirine</td>
<td style="text-align: left;">2021-01-20</td>
<td style="text-align: left;">treatment of hiv-1 infection</td>
</tr>
<tr class="even">
<td style="text-align: left;">AKLIEF</td>
<td style="text-align: left;">trifarotene</td>
<td style="text-align: left;">2019-10-04</td>
<td style="text-align: left;">topical treatment of acne vulgaris in patients 9 years of age and older</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CRESEMBA</td>
<td style="text-align: left;">isavuconazonium sulfate</td>
<td style="text-align: left;">2015-03-06</td>
<td style="text-align: left;">treatment of invasive mucormycosis</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="iteration-5" class="level2">
<h2 class="anchored" data-anchor-id="iteration-5">Iteration 5</h2>
<section id="phase-1-4" class="level3">
<h3 class="anchored" data-anchor-id="phase-1-4">Phase 1</h3>
<p>1) Inner join both tibbles</p>
<p>2) Display final tibble</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join tibbles</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>clinical_demographics <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(clinical_data, drug_snapshots, <span class="at">by =</span> <span class="st">"brand name"</span>, <span class="at">relationship =</span> <span class="st">"many-to-many"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>clinical_demographics <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 843
Columns: 11
$ `brand name`    &lt;chr&gt; "ADDYI", "ADDYI", "ADDYI", "ADDYI", "ADDYI", "ADDYI", …
$ indication      &lt;chr&gt; "treatment of acquired, generalized hypoactive sexual …
$ women           &lt;dbl&gt; 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100,…
$ year            &lt;date&gt; 2015-01-01, 2015-01-01, 2015-01-01, 2015-01-01, 2015-…
$ race            &lt;fct&gt; other, other, other, asian, asian, asian, black, black…
$ `percent race`  &lt;dbl&gt; 2, 2, 2, 1, 1, 1, 8, 8, 8, 89, 89, 89, 1, 1, 7, 91, 1,…
$ age             &lt;fct&gt; 65 to 74, 75 to 79, 80 and up, 65 to 74, 75 to 79, 80 …
$ `percent age`   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 45, 45, 45, 45, 32…
$ `drug name`     &lt;chr&gt; "flibanserin", "flibanserin", "flibanserin", "flibanse…
$ `approval date` &lt;date&gt; 2015-08-18, 2015-08-18, 2015-08-18, 2015-08-18, 2015-…
$ `approved use`  &lt;chr&gt; "treatment, (HSDD)", "treatment, (HSDD)", "treatment, …</code></pre>
</div>
</div>
<p>For the purposes of this project, I will be focusing on the clinical trials data to derive insights on clinical participant demographics. The drug snapshots adds more information to the initial table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Final tibble</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>clinical_demographics <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 38%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">brand name</th>
<th style="text-align: left;">indication</th>
<th style="text-align: right;">women</th>
<th style="text-align: left;">year</th>
<th style="text-align: left;">race</th>
<th style="text-align: right;">percent race</th>
<th style="text-align: left;">age</th>
<th style="text-align: right;">percent age</th>
<th style="text-align: left;">drug name</th>
<th style="text-align: left;">approval date</th>
<th style="text-align: left;">approved use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MULPLETA</td>
<td style="text-align: left;">treatment of adults with low platelet count</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">2018-01-01</td>
<td style="text-align: left;">black</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">65 to 74</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">lusutrombopag</td>
<td style="text-align: left;">2018-07-31</td>
<td style="text-align: left;">treatment of adults with low platelet count</td>
</tr>
<tr class="even">
<td style="text-align: left;">RYDAPT</td>
<td style="text-align: left;">treatment of acute myelogenous leukemia</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">2017-01-01</td>
<td style="text-align: left;">white</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">65 to 74</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">midostaurin</td>
<td style="text-align: left;">2017-04-28</td>
<td style="text-align: left;">treatment, (SM)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PREVYMIS</td>
<td style="text-align: left;">prevention of cytomegalovirus infection in allogeneic hematopoietic stem cell transplant</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">2017-01-01</td>
<td style="text-align: left;">black</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">65 to 74</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">letermovir</td>
<td style="text-align: left;">2017-11-08</td>
<td style="text-align: left;">preventative treatment, (CMV)</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="results-and-visualization" class="level2">
<h2 class="anchored" data-anchor-id="results-and-visualization">Results and Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> clinical_demographics <span class="sc">%&gt;%</span>  </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">str_to_title</span>(race), <span class="at">y =</span> <span class="st">`</span><span class="at">percent race</span><span class="st">`</span>)) <span class="sc">+</span>  </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> race, <span class="at">colour =</span> race)) <span class="sc">+</span>  </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(  </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Race"</span>,   </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percent of People from Race"</span>  </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span>  </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span>  </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>))  </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">facet_wrap</span>(. <span class="sc">~</span> age, <span class="at">labeller =</span> label_both) <span class="sc">+</span>  </span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">x =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">45</span>)) <span class="sc">+</span>  </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Graph 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Clinical-Drug-Trials_files/figure-html/plot_1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Graph 1 illustrates the distribution of clinical trial participants across different racial groups and age categories using box and violin plots.</p>
<section id="age-groups" class="level3">
<h3 class="anchored" data-anchor-id="age-groups"><strong>Age Groups:</strong></h3>
<ul>
<li><p><strong>65 to 74</strong>:</p>
<ul>
<li><p>The “White” category shows a wide distribution, indicating variability in the percentage of participants.</p></li>
<li><p>Other racial groups like “Asian,” “Black,” and “Other” have narrower distributions, suggesting less variability.</p></li>
</ul></li>
<li><p><strong>75 to 79</strong>:</p>
<ul>
<li><p>The “White” category continues to show a wider spread, though less pronounced than the 65 to 74 group.</p></li>
<li><p>Other racial groups maintain narrower distributions.</p></li>
</ul></li>
<li><p><strong>80 and up</strong>:</p>
<ul>
<li><p>The “White” category again shows a wider distribution, indicating variability.</p></li>
<li><p>Other racial groups remain consistent with narrower spreads.</p></li>
</ul></li>
</ul>
</section>
<section id="racial-distribution" class="level3">
<h3 class="anchored" data-anchor-id="racial-distribution"><strong>Racial Distribution:</strong></h3>
<ul>
<li><p>The majority of participants identify as “White,” with a significant density of points indicating a higher percentage.</p></li>
<li><p>Other racial groups have fewer participants, with distributions centered around the mean and fewer outliers.</p></li>
</ul>
</section>
<section id="overall-trends" class="level3">
<h3 class="anchored" data-anchor-id="overall-trends"><strong>Overall Trends:</strong></h3>
<ul>
<li><p>The “White” category shows more variation across age groups, not centered around the mean.</p></li>
<li><p>Other racial groups show less variation, with percentages more centered around the mean and some outliers.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> clinical_demographics <span class="sc">%&gt;%</span>  </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> women)) <span class="sc">+</span>  </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>() <span class="sc">+</span>  </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">50</span>), <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span>  </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Percentage of Women Patients in the Trial"</span>, <span class="at">y =</span> <span class="st">"Cumulative Frequency"</span>) <span class="sc">+</span>  </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(age <span class="sc">~</span> <span class="fu">str_to_title</span>(race)) <span class="sc">+</span>  </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">x =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">45</span>)) <span class="sc">+</span>  </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>), <span class="at">legend.position =</span> <span class="st">"none"</span>)  </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> clinical_demographics <span class="sc">%&gt;%</span>  </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">specific_values =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">50</span>, <span class="at">specific_values =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">ecdf</span>(women)(x)) <span class="sc">%&gt;%</span>  </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> women)) <span class="sc">+</span>  </span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>specific_values), <span class="fu">aes</span>(<span class="at">colour =</span> race)) <span class="sc">+</span>  </span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Percentage of Women Patients in the Trial"</span>, <span class="at">y =</span> <span class="st">"Cumulative Frequency"</span>) <span class="sc">+</span>  </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span>  </span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(specific_values), <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">xend =</span> x, <span class="at">yend =</span> y), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span>  </span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span>  </span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(specific_values), <span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">yend =</span> y), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span>  </span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()  </span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots  </span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span>  </span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(  </span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Graph 2"</span>,   </span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag_levels =</span> <span class="st">"1"</span>,   </span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag_prefix =</span> <span class="st">"p"</span>  </span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span>  </span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>))  </span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot  </span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Clinical-Drug-Trials_files/figure-html/plot_2-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>P1 and p2 in graph 2 provide insights into the distribution of women participants in clinical trials, segmented by race and age groups.</p>
</section>
<section id="p1" class="level3">
<h3 class="anchored" data-anchor-id="p1"><strong>P1:</strong></h3>
<ul>
<li><p><strong>Cumulative Frequency by Race and Age</strong>:</p>
<ul>
<li><p>This panel displays cumulative frequency plots for different racial groups (Asian, Black, Other, White) across three age categories: 65 to 74, 75 to 79, and 80 and up.</p></li>
<li><p>The overlapping distributions indicate that the percentage of women participants is similar across racial groups, as the curves for each race largely coincide.</p></li>
<li><p>However, there is a noticeable variation in the distribution of women participants across age groups. Younger age groups show a lower frequency of trials with 50% women participants compared to older age groups, suggesting that older participants are more likely to be represented in trials.</p></li>
</ul></li>
</ul>
</section>
<section id="p2" class="level3">
<h3 class="anchored" data-anchor-id="p2"><strong>P2:</strong></h3>
<ul>
<li><p><strong>Overall Cumulative Frequency</strong>:</p>
<ul>
<li><p>This plot shows the cumulative frequency of women participants across all trials, with a focus on the percentage of women.</p></li>
<li><p>The red vertical line at 50% indicates a threshold where the frequency of trials with at least 50% women participants is highlighted.</p></li>
<li><p>The cumulative distribution suggests that while there are trials with a higher percentage of women, the overall representation is still skewed, particularly in younger age groups.</p></li>
</ul></li>
</ul>
</section>
<section id="key-observations" class="level3">
<h3 class="anchored" data-anchor-id="key-observations"><strong>Key Observations:</strong></h3>
<ol type="1">
<li><p><strong>Representation of Women</strong>:</p>
<ul>
<li>There is a larger representation of women in clinical trials for older age groups compared to younger ones, as indicated by the cumulative frequency plots.</li>
</ul></li>
<li><p><strong>Racial Distribution</strong>:</p>
<ul>
<li>Across all age groups, the predominant race in clinical trials is White/Caucasian, with similar distribution patterns among different races, although this varies by age.</li>
</ul></li>
<li><p><strong>Trial Participation</strong>:</p>
<ul>
<li>Despite a larger number of clinical trials involving younger participants, the percentage of women in these trials is relatively low, highlighting a disparity in representation.</li>
</ul></li>
</ol>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>The analysis of clinical trial demographics reveals a clear pattern regarding which population benefits most from drug trials and subsequent drug development. Based on the comprehensive data examination, White males between the ages of 65 and 74 emerge as the predominantly represented demographic in clinical trials. This overrepresentation creates a significant skew in drug development and testing, resulting in medications that are primarily validated for this specific demographic group.</p>
<p>The implications of this demographic bias are far-reaching and problematic on multiple levels. When clinical trials consistently favor one demographic group, the resulting pharmaceutical developments are inherently more tailored to that population’s physiological characteristics and needs. This means that White males in their mid-to-late 60s and early 70s receive medications that have been extensively tested on individuals sharing their demographic profile, potentially leading to more predictable and effective treatment outcomes for this group.</p>
<p>However, this bias creates substantial medical concerns for other demographic groups. The human body’s response to medications can vary significantly based on factors such as age, gender, racial background, and genetic makeup. When drugs are primarily tested on a narrow demographic segment, their effectiveness and potential side effects on other populations remain largely unknown until the medication enters widespread use. This creates a dangerous scenario where medications approved based on positive results in one demographic group may produce unexpected or potentially harmful effects in others.</p>
<p>The medical implications of this bias extend beyond simple effectiveness concerns. Different populations may require different dosages, experience varying side effects, or respond differently to treatment protocols. Without adequate representation in clinical trials, these variations remain undiscovered during the testing phase, potentially endangering lives when the drugs are prescribed to members of underrepresented groups.</p>
<p>This situation highlights the urgent need for reform in clinical trial recruitment and participation. To ensure safe and effective medical treatments for all populations, clinical trials must actively seek and include participants from diverse backgrounds, ages, and genders. This diversity in testing would lead to more comprehensive understanding of drug effects across different demographic groups and ultimately result in safer, more effective medical treatments for the entire population.</p>
<p>The current bias in clinical trials not only raises ethical concerns about equality in medical research but also presents a significant challenge to the fundamental goal of medicine: to provide safe and effective treatment for all patients, regardless of their demographic background. Moving forward, the medical research community must prioritize the development of more inclusive clinical trial protocols that ensure representation across all demographic groups, thereby working toward true equality in medicine and healthcare outcomes.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In conclusion, the analysis of clinical trial demographics underscores a significant bias favoring White males aged 65 to 74, leading to skewed drug development outcomes that may not effectively serve other demographic groups. This over representation raises ethical and medical concerns, as medications validated primarily on this narrow population may pose risks or prove ineffective for women, younger individuals, and racial minorities. To address these disparities, it is crucial for the medical research community to implement more inclusive recruitment strategies that ensure diverse representation in clinical trials. By doing so, we can enhance the safety and efficacy of treatments for all patients, ultimately advancing equity in healthcare and improving health outcomes across the population.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p><em>Clinical Trials: Participant Demographic Data</em>. (n.d.). ProPublica Data Store. https://www.propublica.org/datastore/dataset/cancer-clinical-trials-demographics-data</p>
<p>FDA. (2019). <em>Drug Trials Snapshots</em>. U.S. Food and Drug Administration. https://www.fda.gov/drugs/drug-approvals-and-databases/drug-trials-snapshots</p>
<p>FDA. (2024). <em>Drug Trials Snapshots Summary Report (2015 and 2016)</em>. U.S. Food and Drug Administration. https://www.fda.gov/drugs/drug-approvals-and-databases/drug-trials-snapshots-summary-report-2015-and-2016</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>